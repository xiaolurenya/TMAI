<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>AI智能投注系统</title>
    <style>
        .data-panel { margin: 20px; padding: 15px; border: 1px solid #ccc; }
        .countdown { color: #ff0000; font-weight: bold; }
        .bet-btn { padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; }
        .bet-btn:disabled { background: #cccccc; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="data-panel">
        <h3>实时数据 <span id="refresh-time"></span></h3>
        <p>当前胜率: <span id="win-rate">0%</span></p>
        <p>推荐比分: <span id="score-prediction">0-0</span></p>
        <p>投注截止: <span class="countdown" id="countdown">00:00:30</span></p>
        <button class="bet-btn" id="auto-bet-btn" disabled>AI自动投注</button>
    </div>

    <script>
        // 数据刷新间隔(毫秒)
        const REFRESH_INTERVAL = 100; // 100ms刷新一次
        // 自动下注触发时间(秒)
        const AUTO_BET_TRIGGER_SEC = 30;
        
        let countdownSec = 60; // 总倒计时时间(秒)
        let isAutoBetExecuted = false;
        const $winRate = document.getElementById('win-rate');
        const $scorePrediction = document.getElementById('score-prediction');
        const $countdown = document.getElementById('countdown');
        const $autoBetBtn = document.getElementById('auto-bet-btn');
        const $refreshTime = document.getElementById('refresh-time');

        // 更新倒计时显示
        function updateCountdown() {
            const hours = Math.floor(countdownSec / 3600).toString().padStart(2, '0');
            const minutes = Math.floor((countdownSec % 3600) / 60).toString().padStart(2, '0');
            const seconds = (countdownSec % 60).toString().padStart(2, '0');
            $countdown.textContent = `${hours}:${minutes}:${seconds}`;
            
            // 剩余30秒时触发AI最终计算
            if (countdownSec === AUTO_BET_TRIGGER_SEC && !isAutoBetExecuted) {
                aiFinalOptimization();
            }
            
            if (countdownSec <= 0) {
                clearInterval(countdownTimer);
                $autoBetBtn.disabled = true;
                $autoBetBtn.textContent = '投注已截止';
            } else {
                countdownSec--;
            }
        }

        // AI数据优化计算
        function aiDataOptimization() {
            // 模拟AI计算过程
            const winRate = (50 + Math.random() * 40).toFixed(1); // 50%-90%随机胜率
            const homeScore = Math.floor(Math.random() * 3);
            const awayScore = Math.floor(Math.random() * 2);
            
            // 更新UI显示
            $winRate.textContent = `${winRate}%`;
            $scorePrediction.textContent = `${homeScore}-${awayScore}`;
            $refreshTime.textContent = `(最后刷新: ${new Date().toISOString().split('T')[1]})`;
            
            return {
                winRate: parseFloat(winRate),
                score: `${homeScore}-${awayScore}`
            };
        }

        // 最终30秒AI优化
        function aiFinalOptimization() {
            console.log('触发最后30秒AI优化计算');
            const finalData = aiDataOptimization();
            
            // 满足高胜率条件自动投注
            if (finalData.winRate >= 70) { // 胜率阈值可配置
                autoBet(finalData);
            }
        }

        // 自动下注操作
        function autoBet(data) {
            isAutoBetExecuted = true;
            $autoBetBtn.textContent = `已自动投注 (胜率: ${data.winRate}%)`;
            
            // 模拟投注API调用
            console.log(`执行自动投注: 推荐比分${data.score}, 胜率${data.winRate}%`);
            // 实际项目中这里会调用后端投注接口
            // fetch('/api/bet', {
            //     method: 'POST',
            //     body: JSON.stringify({ score: data.score, winRate: data.winRate })
            // });
        }

        // 初始化定时器
        const dataRefreshTimer = setInterval(aiDataOptimization, REFRESH_INTERVAL);
        const countdownTimer = setInterval(updateCountdown, 1000);

        // 手动触发投注按钮
        $autoBetBtn.addEventListener('click', () => {
            if (!isAutoBetExecuted && countdownSec > 0) {
                const currentData = aiDataOptimization();
                autoBet(currentData);
            }
        });

        // 初始加载
        aiDataOptimization();
        updateCountdown();
        $autoBetBtn.disabled = false;
    </script>
</body>
</html>
